<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Counting</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        /* Font Import and Base Styles */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');
        
        body {
            /* Font family: Inter, sans-serif */
            font-family: 'Inter', sans-serif;
            background-color: #ffffff; /* Global background: White */
        }

        /* --- Input Arrow Removal (User Request) --- */
        /* Hide number input arrows for WebKit/Blink browsers (Chrome, Safari, Edge) */
        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        /* Hide number input arrows for Firefox */
        input[type=number] {
            -moz-appearance: textfield;
        }

        /* --- Block Sizing and Appearance --- */

        /* Responsive Font Sizing: REMOVED from display as blocks are now fixed in PX */
        /* #single-card-display and media queries are removed to use fixed block sizes */
        
        /* Ones Blocks (Squares) - Blue: #0f6bb4 (1 unit) */
        .one-block {
            width: 18px; /* Updated to 18px */
            height: 18px; /* Updated to 18px */
            background-color: #0f6bb4; 
            box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.2);
            border: 1px solid #094777; 
        }

        /* Tens Blocks (Stacks) - Green: #12a553 (10 units) */
        .ten-block {
            width: 18px; /* Updated to 18px */
            height: 75px; /* Updated to 75px */
            background-color: #12a553; 
            box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2);
            border: 1px solid #0a6936;
        }

        /* Hundreds Block (Plates) - Burnt Orange: #cc5500 (100 units) */
        .hundred-block {
            width: 75px;  /* Updated to 75px */
            height: 75px; /* Updated to 75px */
            background-color: #cc5500;
            box-shadow: 3px 3px 8px rgba(0, 0, 0, 0.3);
            border: 1px solid #994000;
            margin-right: 25px; /* Converted from 1.5em to px */
        }

        /* Block Layout Wrappers */
        .tens-wrapper {
            display: flex;
            gap: 5px; /* Converted from 0.3em to px */
            margin-right: 20px; /* Converted from 1.0em to px */
        }

        /* Ones Wrapper needs to wrap blocks, keeping the blocks at the bottom of the card */
        .ones-wrapper {
            display: flex;
            flex-wrap: wrap;
            gap: 5px; /* Converted from 0.3em to px */
            max-width: 75px; /* Adjusted to accommodate 3 blocks (18*3 + 5*2 = 64px) */
            align-content: flex-end; /* This ensures the blocks sit at the bottom */
        }

        /* Single Card Display */
        #single-card-display {
            /* Set min-height to accommodate the tallest block (75px) */
            min-height: 100px; /* Added some extra room for padding/visual space */
            /* Card background is white */
            background-color: white; 
        }

        /* Utility to make the blocks render neatly inside the display */
        .block-display {
            min-height: 75px; /* Matches the height of the tallest block */
            align-items: flex-end;
            display: flex; 
            justify-content: center;
        }
        
        /* --- Custom Utility Classes (for color hardcoding) --- */

        /* Text Colors */
        .text-main-blue {
            color: #0f6bb4 !important;
        }
        .text-main-green {
            color: #12a553 !important; 
        }
        .text-burnt-orange {
             color: #cc5500 !important;
        }

        /* Background Colors for Buttons/Elements */
        .bg-main-blue {
            background-color: #0f6bb4;
        }
        .bg-main-blue:hover {
            background-color: #0a4f77;
        }

        /* Success/Error Feedback */
        .text-feedback-green {
            color: #12a553;
        }
        .text-feedback-red {
            color: #d0021b; 
        }
    </style>
</head>
<body class="min-h-screen flex items-start justify-center p-4 sm:p-8">
    <!-- Main container has a white background and no external shadow -->
    <div id="game-container" class="w-full max-w-xl bg-white rounded-xl">
        
        <!-- 1. Title and How to Play Button (on white background) -->
        <div class="text-center pt-6 px-6 sm:pt-8 sm:px-8">
            <h1 class="text-4xl font-bold text-gray-800 mb-2">Counting</h1>
            <button id="show-rules-button" class="text-sm font-semibold text-white py-2 px-4 rounded-lg shadow-md transition duration-150 bg-main-blue mb-4">
                How to Play
            </button>
        </div>

        <!-- 2. Score Bar (Gray Background: #f3f4f5). NOW ROUNDED and full width to match playing area -->
        <!-- Removed mx-6 and updated padding to p-6 for alignment -->
        <div class="bg-[#f3f4f5] p-6 text-center rounded-xl">
            <div id="score-display" class="text-xl font-semibold text-gray-700">Score: 0</div>
        </div>
        
        <!-- 3. Pale Blue Playing Area: #e6f0f7. Added margin and padding/rounding adjusted. -->
        <!-- The mt-4 margin creates the white gap -->
        <div class="bg-[#e6f0f7] p-6 sm:p-8 rounded-xl mt-4">
            
            <!-- Block Display Area (background is white) -->
            <!-- UPDATED: Changing pb-3 to pb-4 for larger bottom padding (16px) -->
            <div id="single-card-display" class="px-4 pt-4 pb-4 rounded-xl shadow-md border-2 border-gray-200">
                <!-- Blocks will be rendered here -->
            </div>

            <!-- Status Message Area (MOVED BELOW CARD) -->
            <div id="status-message" class="text-center text-xl font-semibold min-h-[1.5rem] mt-4 mb-3">What number is shown?</div>

            <!-- Input Area and Check Button -->
            <div class="text-center">
                <div class="flex flex-col sm:flex-row justify-center items-center space-y-3 sm:space-y-0 sm:space-x-3">
                    <input type="number" id="user-input" placeholder="" class="p-3 border-2 border-gray-300 rounded-lg text-center text-2xl font-bold w-full sm:w-40 focus:border-main-blue focus:ring-1 focus:ring-main-blue" min="0" max="299">
                    <button id="check-button" class="bg-main-blue text-white font-bold py-3 px-6 rounded-lg shadow-lg transition duration-200 w-full sm:w-auto">
                        Submit
                    </button>
                </div>
            </div>
        </div>

        <!-- Rules Modal (kept outside the flow) -->
        <div id="rules-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
            <div class="bg-white p-8 rounded-xl shadow-3xl w-full max-w-md transform transition-all duration-300 scale-95">
                <h3 class="text-3xl font-bold text-main-blue mb-4 border-b pb-2">How to Play</h3>
                <div class="text-gray-700 space-y-3 mb-6">
                    <p>The goal is to match the number shown by correctly counting the value of the colored blocks and entering the number.</p>
                    
                    <p class="font-semibold text-lg">Block Values:</p>
                    <ul class="list-none ml-0 space-y-2 text-left">
                        <li class="text-gray-700"><span class="font-bold text-burnt-orange">Orange Plates:</span> 100</li>
                        <!-- This line uses text-main-green, which is #12a553 -->
                        <li class="text-gray-700"><span class="font-bold text-main-green">Green Stacks:</span> 10</li>
                        <li class="text-gray-700"><span class="font-bold text-main-blue">Blue Squares:</span> 1</li>
                    </ul>
                    
                    <p class="pt-2">Keep guessing until you find the correct number!</p>
                </div>
                <button id="close-rules-button" class="bg-main-blue hover:bg-main-blue/90 text-white font-bold py-2 px-6 rounded-lg transition duration-200">
                    Got it!
                </button>
            </div>
        </div>

    </div>

    <script>
        // Global state
        let currentTargetNumber = 0;
        let score = 0;
        
        // Configuration
        const MAX_NUMBER = 299; // Maximum number is 299
        const MIN_NUMBER = 11; 
        
        // DOM elements
        const singleCardDisplay = document.getElementById('single-card-display');
        const scoreDisplayEl = document.getElementById('score-display');
        const userInput = document.getElementById('user-input');
        const checkButton = document.getElementById('check-button');
        const statusMessageEl = document.getElementById('status-message'); 
        
        // Rules Modal Elements
        const showRulesButton = document.getElementById('show-rules-button');
        const rulesModal = document.getElementById('rules-modal');
        const closeRulesButton = document.getElementById('close-rules-button');


        // --- Rules Modal Logic ---
        showRulesButton.addEventListener('click', () => {
            rulesModal.classList.remove('hidden');
        });

        closeRulesButton.addEventListener('click', () => {
            rulesModal.classList.add('hidden');
        });
        // -------------------------


        /**
         * Generates the HTML for the block visualization based on hundreds, tens, and ones counts.
         */
        function renderBlocks(hundreds, tens, ones) {
            let hundredsHTML = '';
            for (let i = 0; i < hundreds; i++) {
                hundredsHTML += `<div class="hundred-block rounded-md"></div>`;
            }

            let tensHTML = '';
            for (let i = 0; i < tens; i++) {
                tensHTML += `<div class="ten-block rounded-md"></div>`;
            }

            let onesHTML = '';
            // Display ones as a wrapped group
            for (let i = 0; i < ones; i++) {
                onesHTML += `<div class="one-block rounded-sm"></div>`;
            }

            return `
                <div class="block-display">
                    <!-- Hundreds Blocks (Plates) -->
                    <div class="hundreds-wrapper flex gap-0.5">${hundredsHTML}</div>
                    <!-- Tens Blocks (Stacks) -->
                    <div class="tens-wrapper">${tensHTML}</div>
                    <!-- Ones Blocks (Squares) -->
                    <div class="ones-wrapper">${onesHTML}</div>
                </div>
            `;
        }
        
        /**
         * Starts a new counting problem.
         */
        function generateProblem() {
            // Pick a random number between MIN_NUMBER (11) and MAX_NUMBER (299)
            currentTargetNumber = Math.floor(Math.random() * (MAX_NUMBER - MIN_NUMBER + 1)) + MIN_NUMBER;
            
            // Decompose the target number for rendering
            const hundreds = Math.floor(currentTargetNumber / 100);
            const tens = Math.floor((currentTargetNumber % 100) / 10);
            const ones = currentTargetNumber % 10;
            
            // Render the blocks
            singleCardDisplay.innerHTML = renderBlocks(hundreds, tens, ones);
            
            // Clear input and set initial prompt
            userInput.value = '';
            // Reset message to the default prompt
            statusMessageEl.textContent = 'What number is shown?';
            statusMessageEl.classList.remove('text-feedback-green', 'text-feedback-red');
            userInput.focus();
        }

        /**
         * Handles the user's answer submission.
         */
        function checkAnswer() {
            const inputValue = parseInt(userInput.value, 10);
            
            // Input validation
            if (isNaN(inputValue)) {
                statusMessageEl.textContent = "Please enter a number.";
                statusMessageEl.classList.remove('text-feedback-green');
                statusMessageEl.classList.add('text-feedback-red');
                return;
            }

            if (inputValue === currentTargetNumber) {
                // CORRECT ANSWER LOGIC
                score++;
                scoreDisplayEl.textContent = `Score: ${score}`;

                statusMessageEl.textContent = `Correct! ${currentTargetNumber} is the right count. Generating new problem...`;
                statusMessageEl.classList.remove('text-feedback-red');
                statusMessageEl.classList.add('text-feedback-green');
                
                // Disable button and input briefly
                checkButton.disabled = true;
                userInput.disabled = true;

                // Delay before generating the next problem
                setTimeout(() => {
                    checkButton.disabled = false;
                    userInput.disabled = false;
                    generateProblem();
                }, 1500);

            } else {
                // INCORRECT ANSWER LOGIC
                statusMessageEl.textContent = "Incorrect. Try counting again!";
                statusMessageEl.classList.remove('text-feedback-green');
                statusMessageEl.classList.add('text-feedback-red');
                
                // Clear input for easy re-entry (it was already clearing, but ensures it happens)
                userInput.value = ''; 
                userInput.focus();
            }
        }
        
        // Event listener for the Check button
        checkButton.addEventListener('click', checkAnswer);
        
        // Allow pressing Enter key to check answer
        userInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                checkAnswer();
            }
        });

        // Initial setup
        window.onload = generateProblem;

    </script>
</body>
</html>